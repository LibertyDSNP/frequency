# Design Doc for P256 PassKey Support

## Table of Contents

- [Design Doc for P256 PassKey Support](#design-doc-for-p256-passkey-support)
  - [Table of Contents](#table-of-contents)
  - [1. Introduction](#1-introduction)
  - [2. Terminology](#2-terminology)
    - [Accounts](#accounts)
    - [Keys](#keys)
    - [Signatures](#signatures)
  - [3.1. Data Flow Diagram](#31-data-flow-diagram)
  - [3.2. Data maps for Legal Teams](#32-data-maps-for-legal-teams)
  - [4. Benefits](#4-benefits)
  - [5. Specification](#5-specification)
    - [Passkey Registration](#passkey-registration)
    - [Security Considerations](#security-considerations)
    - [Transaction Submission Specification](#transaction-submission-specification)
  - [6. Implementation](#6-implementation)
    - [Backend Example Code](#backend-example-code)
    - [Frontend Example Code](#frontend-example-code)
  - [7. Options for Discussion](#7-options-for-discussion)
    - [Unsigned Extensions vs MultiSignature](#unsigned-extensions-vs-multisignature)
    - [Generic Key Support](#generic-key-support)
    - [Separate Pallet](#separate-pallet)
  - [8. Conclusion](#8-conclusion)

## 1. Introduction

This document outlines the design considerations and specifications for integrating P256 Passkey support for performing transactions on Frequency chain. Passkey support aims to provide a novel non custodial solution for managing user accounts and signing transactions on-chain.

## 2. Terminology

### Accounts

- **Passkey Account**: The user account associated with the Passkey.
- **Frequency Account**: The account used for on-chain transactions and interactions. This account is derived from a seed phrase generated by Frequency Access.
- **Frequency Access**: The platform facilitating the management and interaction with user accounts.

### Keys

- **Passkey**: P256 key pair used for transaction signing and account management. This is the primary key used for transaction signing.
- **Passkey Public Key**: The public key derived from the Passkey private key.
- **Account Key**: A mnemonic phrase used to generate the Frequency Account key pair.
- **Account Public Key**: The public key derived from a seed phrase generated by Frequency Access.

### Signatures

- **Account signature on PassKey Public Key**: A cryptographic signature generated using the Account Key. The data being signed is passkey public key. This is used to prove ownership of Account Key.
- **Passkey Signatures**: A cryptographic signature generated using the Passkey private key. This is presented to passkey enabled services as a challenge-response mechanism. Passkeys are used to generate two signatures as follows:
  - **Signature on Account Public Key**: Passkey signs a message containing the account public key. This signature is retained by the Frequency Access platform and/or maybe used for account recovery.
  - **Signature on Transactions**: Passkey signs the transaction payload which needs to be submitted on-chain. This signature is used to verify the authenticity of the transaction.

## 3.1. Data Flow Diagram

![Data Flow Diagram](insert_diagram_link_here)

## 3.2. Data maps for Legal Teams

## 4. Benefits

- **Non-Custodial Account Management**: Passkey support enables users to interact with Frequency chain without actual seed access. This reduces the risk of seed exposure and enhances security.

- **Functionality**: Passkey support provides a better user experience by enabling users to sign transactions without seed access. The poliferation of passkey enabled services can lead to a seamless user experience.

- **Interoperability**: The use of standard cryptographic protocols (e.g., P256) ensures compatibility with other systems and services that also support these standards. This can facilitate integrations with existing wallets, security modules, and third-party applications.

- **Backup and Recovery**: Passkey support can be used to facilitate account recovery and backup mechanisms. By signing the account public key, users can prove ownership of the account and recover access in case of loss of seed access.

## 5. Specification

### Passkey Registration

(Describe the process of Passkey registration, including user interactions, key generation, and backend storage.)

### Security Considerations

(Outline the security measures to be implemented both on the client-side and server-side to ensure the safety of user data and transactions.)

### Transaction Submission Specification

(Provide a detailed specification for forming and submitting transactions on-chain, including inputs, hashes, signature data, and necessary extensions.)

## 6. Implementation

### Backend Example Code

(Include code snippets demonstrating how to implement Passkey support on the backend.)

### Frontend Example Code

(Include code snippets demonstrating how to implement Passkey support on the frontend.)

## 7. Options for Discussion

### Unsigned Extensions vs MultiSignature

(Discuss the pros and cons of using unsigned extensions versus multisignature schemes for transaction verification.)

### Generic Key Support

(Consider whether to support keys from wallets other than those generated by Passkey.)

### Separate Pallet

(Discuss the feasibility and benefits of implementing Passkey support as a separate pallet within the system.)

## 8. Conclusion

(Summarize the key points of the design document and outline next steps for implementation and further discussion.)
