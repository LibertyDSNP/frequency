# Design Doc for P256 PassKey Support

## Table of Contents

- [Design Doc for P256 PassKey Support](#design-doc-for-p256-passkey-support)
  - [Table of Contents](#table-of-contents)
  - [1. Introduction](#1-introduction)
  - [2. Terminology](#2-terminology)
    - [Accounts](#accounts)
    - [Keys](#keys)
    - [Signatures](#signatures)
  - [3. Data Flow Diagram](#3-data-flow-diagram)
  - [4. Data Map for Legal Teams](#4-data-map-for-legal-teams)
  - [5. Specification](#5-specification)
    - [Passkey Registration](#passkey-registration)
    - [Security Considerations](#security-considerations)
    - [Transaction Submission Specification](#transaction-submission-specification)
  - [6. Implementation](#6-implementation)
    - [Backend Example Code](#backend-example-code)
    - [Frontend Example Code](#frontend-example-code)
  - [7. Options for Discussion](#7-options-for-discussion)
    - [Unsigned Extensions vs MultiSignature](#unsigned-extensions-vs-multisignature)
    - [Generic Key Support](#generic-key-support)
    - [Separate Pallet](#separate-pallet)
  - [8. Conclusion](#8-conclusion)

## 1. Introduction

This document outlines the design considerations and specifications for integrating P256 Passkey support for performing transactions on Frequency chain. Passkey support aims to provide a novel non custodial solution for managing user accounts and signing transactions on-chain.

## 2. Terminology

### Accounts

- **Authorized Account**: The user account associated with the Passkey.
- **Parent Account**: The account holding the primary private key for transaction signing.
- **Frequency Access**: The platform facilitating the management and interaction with user accounts.

### Keys

- **Passkey**: P256 key pair used for transaction signing and account management. This is the primary key used for transaction signing.
- **Passkey Public Key**: The public key derived from the Passkey private key.
- **Seed Phrase**: A mnemonic phrase used to generate cryptographic keys, particularly for SR25519 accounts. This is used for signing passkey proving account ownership.
- **Seed Public Key**: The public key derived from the Seed Phrase.

### Signatures

- **Seed signature on PassKey Public Key**: A cryptographic signature generated using the Seed Phrase private key. The data being signed is public key derived from passkey. This is used to prove ownership of parent account.
- **Passkey Signature**: A cryptographic signature generated using the Passkey private key. This is presented to passkey enabled services as a challenge-response mechanism. Passkeys are used to generate two signatures as follows:
  - **Signature on Seed Public Key**: Passkey signs a message containing the Seed Public Key. This signature is retained by the Frequency Access platform and/or maybe used for account recovery.
  - **Signature on Transactions**: Passkey signs the transaction payload which needs to be submitted on-chain. This signature is used to verify the authenticity of the transaction.

## 3. Data Flow Diagram

![Data Flow Diagram](insert_diagram_link_here)

## 4. Data Map for Legal Teams

(Provide a data map detailing what information is stored, where it's stored, and its legal implications.)

## 5. Specification

### Passkey Registration

(Describe the process of Passkey registration, including user interactions, key generation, and backend storage.)

### Security Considerations

(Outline the security measures to be implemented both on the client-side and server-side to ensure the safety of user data and transactions.)

### Transaction Submission Specification

(Provide a detailed specification for forming and submitting transactions on-chain, including inputs, hashes, signature data, and necessary extensions.)

## 6. Implementation

### Backend Example Code

(Include code snippets demonstrating how to implement Passkey support on the backend.)

### Frontend Example Code

(Include code snippets demonstrating how to implement Passkey support on the frontend.)

## 7. Options for Discussion

### Unsigned Extensions vs MultiSignature

(Discuss the pros and cons of using unsigned extensions versus multisignature schemes for transaction verification.)

### Generic Key Support

(Consider whether to support keys from wallets other than those generated by Passkey.)

### Separate Pallet

(Discuss the feasibility and benefits of implementing Passkey support as a separate pallet within the system.)

## 8. Conclusion

(Summarize the key points of the design document and outline next steps for implementation and further discussion.)
